<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:common="using:VaultKeeper.AvaloniaApplication.Views.Common"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="using:VaultKeeper.AvaloniaApplication.Views.Settings"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:VaultKeeper.AvaloniaApplication.ViewModels.Settings"
             mc:Ignorable="d" d:DesignWidth="1920" d:DesignHeight="2000"
             x:Class="VaultKeeper.AvaloniaApplication.Views.Settings.SettingsPageView"
             x:DataType="vm:SettingsPageViewModel">
  <Design.DataContext>
    <x:Static Member="vm:SettingsPageViewModel.Design"/>
  </Design.DataContext>

  <ScrollViewer>
    <StackPanel Margin="20">
      <common:AppButton Margin="0 0 0 10"
                        Text="Restore Default Settings"
                        IconStart="{StaticResource IconArrowRotateRight}"
                        HorizontalAlignment="Right"
                        Click="RestoreDefaultSettingsButton_Click"/>

      <local:SettingsSectionShell HeaderText="Theming" HeaderIcon="{StaticResource IconPalette}">
        <StackPanel Spacing="20">

          <StackPanel Spacing="10">
            <Label>Theme Color</Label>

            <ListBox ItemsSource="{Binding ThemeDefinitions}"
                     SelectedItem="{Binding CurrentThemeDefinition}"
                     HorizontalAlignment="Left">
              <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                  <StackPanel Orientation="Horizontal" Margin="10" />
                </ItemsPanelTemplate>
              </ListBox.ItemsPanel>

              <ListBox.ItemTemplate>
                <DataTemplate>
                  <StackPanel>
                    <Border Width="100" Height="75" Background="{Binding BackgroundBrush}">
                      <StackPanel Margin="10 10 10 20" Background="{Binding ForegroundBrush}">
                        <Border Margin="10 10 0 0" Width="50" Height="4" Background="{Binding BackgroundBrush}" HorizontalAlignment="Left"/>
                        <Border Margin="10 3 0 0" Width="33" Height="4" Background="{Binding BackgroundBrush}" HorizontalAlignment="Left"/>
                        <Border Margin="10 3 0 0" Width="25" Height="4" Background="{Binding BackgroundBrush}" HorizontalAlignment="Left"/>
                      </StackPanel>
                    </Border>
                    <TextBlock Margin="0 10 0 0" FontWeight="SemiBold" Text="{Binding ThemeName}"/>
                  </StackPanel>
                </DataTemplate>
              </ListBox.ItemTemplate>

            </ListBox>
          </StackPanel>

          <StackPanel Margin="0 10 0 0">
            <Label Target="PART_FontSizeInput">Font Size</Label>
            <NumericUpDown Name="PART_FontSizeInput"
                           Value="{Binding FontSize}"
                           VerticalContentAlignment="Center"
                           Minimum="1"
                           Maximum="100"
                           FormatString="0"/>
          </StackPanel>

        </StackPanel>
      </local:SettingsSectionShell>

      <local:SettingsSectionShell HeaderText="Backup And Restore" HeaderIcon="{StaticResource IconArrowsRotate}">
        <StackPanel Spacing="20">

          <StackPanel>
            <Label Target="PART_BackupDirectoryInput">Backup Directory</Label>
            <TextBox Name="PART_BackupDirectoryInput"
                     Text="{Binding BackupDirectory}"
                     VerticalContentAlignment="Center">
              <TextBox.InnerRightContent>
                <common:AppButton IconStart="{StaticResource IconFolder}"
                                  Click="SelectDirectoryButton_Click"
                                  ToolTip.Tip="Select Directory" />
              </TextBox.InnerRightContent>
            </TextBox>
            <TextBlock Margin="0 4 0 0"
                       Foreground="Red"
                       FontWeight="SemiBold"
                       Text="Backup directory is not a valid path."
                       IsVisible="{Binding IsBackupDirectoryInvalid}"/>
            <TextBlock Margin="0 4 0 0"
                       Foreground="DarkOrange"
                       FontWeight="SemiBold"
                       Text="Backup directory does not exist and will be created."
                       IsVisible="{Binding !DoesBackupDirectoryExist}"/>
          </StackPanel>

          <StackPanel>
            <Label Target="PART_MaxBackupsInput">Max Backups</Label>
            <NumericUpDown Name="PART_MaxBackupsInput"
                           Value="{Binding MaxBackups}"
                           VerticalContentAlignment="Center"
                           Minimum="1"
                           Maximum="100"
                           FormatString="0"/>
          </StackPanel>

          <Grid RowDefinitions="Auto" ColumnDefinitions="Auto, *">
            <CheckBox Name="PART_AutoBackupCheckBox" IsChecked="{Binding AutoBackupOnShutdown}" Grid.Column="0"/>
            <Label Target="PART_AutoBackupCheckBox" VerticalAlignment="Center" Grid.Column="1">
              <TextBlock TextWrapping="Wrap" MaxLines="4">Automatically create backup when <Run Text="{StaticResource AppName}"/> shuts down.</TextBlock>
            </Label>
          </Grid>

          <StackPanel Orientation="Horizontal" Spacing="10">
            <common:AppButton Text="Backup Now"
                              IconStart="{StaticResource IconDownload}"
                              IsEnabled="{Binding !IsBackupDirectoryInvalid}"
                              Click="BackupNowButton_Click"/>

            <common:AppButton Text="Load Backup"
                              IconStart="{StaticResource IconUpload}"
                              Click="LoadBackupButton_Click" />
          </StackPanel>

        </StackPanel>
      </local:SettingsSectionShell>

      <local:SettingsSectionShell HeaderText="Default Key Generation Settings" HeaderIcon="{StaticResource IconVault}">
        <StackPanel Spacing="20">

          <UniformGrid Rows="1" Columns="2" ColumnSpacing="20">
            <StackPanel>
              <Label Target="PART_KeyGenMinCharLengthInput">Minimum Key Length</Label>
              <NumericUpDown Name="PART_KeyGenMinCharLengthInput"
                             Value="{Binding KeyGenMinLength}"
                             Minimum="1"
                             Maximum="{Binding KeyGenMaxLength}"
                             FormatString="0"/>
            </StackPanel>

            <StackPanel>
              <Label Target="PART_KeyGenMaxCharLengthInput">Maximum Key Length</Label>
              <NumericUpDown Name="PART_KeyGenMaxCharLengthInput"
                             Value="{Binding KeyGenMaxLength}"
                             Minimum="1"
                             Maximum="100"
                             FormatString="0"/>
            </StackPanel>
          </UniformGrid>

          <StackPanel Spacing="10">
            <Label>Character Set</Label>

            <ListBox ItemsSource="{Binding CharSets}"
                     SelectedItem="{Binding CurrentCharSet}"
                     SelectedValueBinding="{Binding Type}">
              <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                  <StackPanel Margin="10" />
                </ItemsPanelTemplate>
              </ListBox.ItemsPanel>

              <ListBox.ItemTemplate>
                <DataTemplate>
                  <UniformGrid RowSpacing="0" Rows="1" Columns="2">
                    <TextBlock Text="{Binding Name}"/>
                    <TextBox Text="{Binding Chars}"
                             IsReadOnly="True"
                             Focusable="False" />
                  </UniformGrid>

                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
          </StackPanel>

        </StackPanel>
      </local:SettingsSectionShell>

    </StackPanel>
  </ScrollViewer>
</UserControl>
